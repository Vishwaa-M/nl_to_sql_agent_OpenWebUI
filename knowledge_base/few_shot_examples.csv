question,sql_query
What was our total profit last year?,SELECT SUM(profit) AS total_profit FROM sales WHERE EXTRACT(YEAR FROM sale_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;
What are the top 5 products by total revenue?,"SELECT p.trade_name, SUM(s.total_revenue) AS total_revenue FROM sales s JOIN products p ON s.product_id = p.product_id GROUP BY p.trade_name ORDER BY total_revenue DESC LIMIT 5;"
How many units of antiviral drugs were sold in the USA?,SELECT SUM(s.quantity_sold) FROM sales s JOIN products p ON s.product_id = p.product_id JOIN distributors d ON s.distributor_id = d.distributor_id WHERE p.therapeutic_area = 'Antivirals' AND d.country = 'USA';
Show me the total monthly revenue for the last 6 months.,"SELECT DATE_TRUNC('month', sale_date)::DATE AS sales_month, SUM(total_revenue) AS monthly_revenue FROM sales WHERE sale_date >= (CURRENT_DATE - INTERVAL '6 months') GROUP BY sales_month ORDER BY sales_month;"
What is the most recent stock quantity for product ID 25 at the 'USA WH 1' warehouse?,SELECT quantity_on_hand FROM inventory_snapshots inv JOIN warehouses w ON inv.warehouse_id = w.warehouse_id WHERE inv.product_id = 25 AND w.location_name = 'USA WH 1' ORDER BY inv.snapshot_date DESC LIMIT 1;
Which distributor generated the highest profit for cardiovascular products in the last quarter?,"SELECT d.name, SUM(s.profit) AS total_profit FROM sales s JOIN distributors d ON s.distributor_id = d.distributor_id JOIN products p ON s.product_id = p.product_id WHERE p.therapeutic_area = 'Cardiovascular' AND s.sale_date >= DATE_TRUNC('quarter', CURRENT_DATE) - INTERVAL '3 months' AND s.sale_date < DATE_TRUNC('quarter', CURRENT_DATE) GROUP BY d.name ORDER BY total_profit DESC LIMIT 1;"
List all sales transactions handled by the distributor 'AmerisourceBergen'.,"SELECT s.sale_id, p.trade_name, s.quantity_sold, s.total_revenue, s.sale_date FROM sales s JOIN products p ON s.product_id = p.product_id JOIN distributors d ON s.distributor_id = d.distributor_id WHERE d.name = 'AmerisourceBergen' ORDER BY s.sale_date DESC LIMIT 20;"
Which 5 products have the highest average profit margin?,"SELECT p.trade_name, AVG((s.unit_price - p.unit_cost) / p.unit_cost) * 100 AS avg_margin_percentage FROM sales s JOIN products p ON s.product_id = p.product_id WHERE p.unit_cost > 0 GROUP BY p.trade_name ORDER BY avg_margin_percentage DESC LIMIT 5;"
What is the total sales revenue for each distributor tier?,"SELECT d.tier, SUM(s.total_revenue) AS total_revenue FROM sales s JOIN distributors d ON s.distributor_id = d.distributor_id GROUP BY d.tier ORDER BY total_revenue DESC;"
Find the latest inventory snapshot for all products in the 'Europe' region.,"SELECT p.trade_name, w.location_name, i.quantity_on_hand, i.snapshot_date FROM inventory_snapshots i JOIN products p ON i.product_id = p.product_id JOIN warehouses w ON i.warehouse_id = w.warehouse_id WHERE w.country IN ('Germany', 'UK', 'Ireland') AND i.snapshot_date = (SELECT MAX(snapshot_date) FROM inventory_snapshots);"
Compare the total profit from 'Gold' tier distributors versus 'Silver' tier distributors.,"SELECT d.tier, SUM(s.profit) as total_profit FROM sales s JOIN distributors d ON s.distributor_id = d.distributor_id WHERE d.tier IN ('Gold', 'Silver') GROUP BY d.tier;"
Which month last year had the highest sales volume for antibiotics?,"SELECT TO_CHAR(sale_date, 'YYYY-MM') AS sales_month, SUM(quantity_sold) AS total_quantity FROM sales s JOIN products p ON s.product_id = p.product_id WHERE p.therapeutic_area = 'Antibiotics' AND EXTRACT(YEAR FROM sale_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 GROUP BY sales_month ORDER BY total_quantity DESC LIMIT 1;"
